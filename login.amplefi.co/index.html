<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<META xmlns="http://www.w3.org/2002/01/P3Pv1">
	<POLICY-REFERENCES>
		<EXPIRY max-age="172800"/>
		<POLICY-REF about="https://s3.amazonaws.com/www.amplefi.us/policy/public.xml">

		</POLICY-REF>
	</POLICY-REFERENCES>
</META>
<title>Amplefi Login</title>
<link href="style.css" rel="stylesheet" type="text/css" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="jquery.placeholder.js"></script>
<script type="text/javascript" src="jquery.cookie.js"></script>
<script src="jquery.login.js"></script>
<script>
   $(function() {
    $('input, textarea').placeholder();
   });
</script>
<script>
$(document).ready(function(){
$('body').on('click', '.log-out', function (e) {
	$.removeCookie('session', { path: '/' });
		 window.location = "http://logout.seeconsulting.us/index_v4.html"
		 event.preventDefault();
	});
});
$(document).ready(function () {
	 $(".signin").hide();
    var session = $.cookie('session');
    if (session != null) {
        $.getJSON("https://v4.amplefi.co/auth_page?callback=?", {
                token: (session)
            },
            function (data) {
                if (data.status == 'authorized') {
                    $(".signin").hide();
                    clearAll();
					$(".logout").fadeIn("fast");
					               $.each(data.package.array, function (i, item) {
                            $(".dropdown").append("<li><a href='" + item.link + "'>" + item.title + "</a></li>");
                            $("a").click(function (event) {
                                var href = $(this).attr('href');
                                window.location = href
          });
      });

                    setTimeout(function () {
                        $(".user-name").html("<p>Hello, " + data.first_name + "!</p>");
                        $(".append-name").fadeIn(500);
                    }, 300);

                    setTimeout(function () {
                        $(".chooser").fadeIn(500);
                    }, 300);
                } else {
                    $(".chooser").hide();
					$(".signin").show();


                }
            });
    } else {

		 $(".signin").show();
    }
});
</script>
<script>
$(document).ready(function () {
    $(".email-input").focus(function () {
        clearAll();
    });
    $('.submit-signin').submit(function () {
		clearAll();
		var email = $(".email-input").val();
		if ($(".email-input").val().length == 0) {
   				return false;
}
else {

        $("#email").addClass("load");
        var cust = "amplefi";
        $.getJSON("https://v4.amplefi.co/auth?callback=?", {
                user: (email),
                cust: (cust)
            },
            function (data) {
                if (data.status == 'authorized') {
                    $("#email").removeClass("load").addClass("check");
                    setTimeout(function () {
                        $(".show-next").fadeIn(500);

                    }, 300);
					setTimeout(function () {
                        $(".pass-input").focus();

                    }, 330);
					$(".pass-input").focus();
                    setTimeout(function () {
                        $(".login").fadeIn(800);
                        $(".login").html('Sign in');
                    }, 350);
                    $(".submit-signin").submit(function () {

						$("#pass").addClass("load");
                        var email = $("#email-main").val();
                        var pass = $("#pass-main").val();
                        $.getJSON("https://v4.amplefi.co/auth_pwd?callback=?", {
                                user: (email),
                                pwd: (pass)
                            },
                            function (data) {
                                if (data.status == 'authenticated') {
									$("#email").removeClass("load").addClass("check");
									$(".wrapper-form").hide();
									$.cookie('session',data.token, {path: '/'});
									window.location = "http://token-co.seeconsulting.us/v4_token.html?master_key="+data.master_key+"&token="+data.token+"&entry_site=secure";				
                                }
								else if (data.status == 'invalidpassword') {
					$(".user-message").empty();
                    $(".login-form").css("border-color", "#ffc1c1");
                    $("#pass").removeClass("load").addClass("cross");
                                  $(".user-message").append("<p>Please enter a valid password.</p>").fadeIn(500);
                                }
                            });
                     return false;
                    });
                } else if (data.status == 'pendingconfirmation') {
                    $(".user-message").empty();
                    $(".login-form").css("border-color", "#2fb0df");
                    $("#email").removeClass("load").addClass("email-highlight");
					 $(".login").html("Resend Email");
                    $(".user-message").append("<p>Your email address is good but you need to verify your account. We've sent you an email.</p>").fadeIn(500);
                } else if (data.status == 'notauthorized') {
                    $(".user-message").empty();
                    $(".login-form").css("border-color", "#ffc1c1");
                    $("#email").removeClass("load").addClass("cross");
                    $(".user-message").append("<p>Your email address is not in our system.</p>").fadeIn(500);
                }
            });
        return false;
}
    });
});
</script>
</head>
<body>
<div class="logout">
	<a class="log-out" href="#">Sign Out</a>
</div>
<div id="wrapper-form" >
  <div class="logo"><img src="images/logo_retina.png" width="210"  alt="logo" /> </div>
  <div class="signin" style="">

    <form class="submit-signin">
      <div class="login-form">
        <div class="left" id="form">
          <input  type="email" id="email-main" class="email-input" placeholder="Enter your email address"/>
        </div>
        <div class="left email" id="email"></div>
        <div class="show-next" style="display: none">
          <div class="sep"></div>
          <div class="left" id="form">
            <input id="pass-main" type="password" class="pass-input" placeholder="Password"/>
          </div>
          <div class="icon-wrapper">
            <div class="left pass" id="pass"></div>
          </div>
        </div>
        <div class="clear"></div>
      </div>
      <div class="user-message"> </div>
      <div class="signin-button">
        <button class="login" type="submit">Next</button>
      </div>
    </form>
    <div style="" class="form-help">
      
    </div>
  </div>
   <div style="display: none" class="append-name"><div class="user-name"></div></div>
  <div class="chooser" style="display: none;">
    <section class="main">
      <div class="wrapper-demo">
        <div id="dd" class="wrapper-dropdown-3" tabindex="1"> <span id="value">Select which site you'd like to visit...</span>
          <ul class="dropdown">

          </ul>
        </div>
        â€‹</div>
    </section>
  </div>
</div>
</div>
<script type="text/javascript">
function DropDown(el) {
				this.dd = el;
				this.placeholder = this.dd.children('span');
				this.opts = this.dd.find('ul.dropdown > li');
				this.val = '';
				this.index = -1;
				this.initEvents();
			}
			DropDown.prototype = {
				initEvents : function() {
					var obj = this;

					obj.dd.on('click', function(event){
						$(this).toggleClass('active');
						return false;
					});

					obj.opts.on('click',function(){
						var opt = $(this);
						obj.val = opt.text();
						obj.index = opt.index();
						obj.placeholder.text(obj.val);
					});
				},
				getValue : function() {
					return this.val;
				},
				getIndex : function() {
					return this.index;
				}
			}

			$(function() {

				var dd = new DropDown( $('#dd') );

				$(document).click(function() {
					// all dropdowns
					$('.wrapper-dropdown-3').removeClass('active');
				});

			});
$("#select-client").click(function(){
				var selected = $("#value").text();
				alert(selected);
			});
		</script>
</body>
</html>
